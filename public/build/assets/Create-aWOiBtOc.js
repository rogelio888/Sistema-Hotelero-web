import{r as v,g as V,h as ue,c as r,a as t,i as h,F as f,A as x,e as i,d as H,B as $,s as u,l as L,p as q,v as m,m as b,t as o,k as E,q as de,o as n,n as P}from"./app-DWQ7THlv.js";import{u as pe}from"./reservas-Cq-m4-rN.js";import{u as ve}from"./hoteles-Cj_n2tFk.js";import{u as ce}from"./huespedes-CiUlC-eS.js";import{u as be}from"./habitaciones-BXYPAQ8z.js";import{_ as g}from"./Button-AgtSY3Ng.js";import{M as me}from"./Modal-B7Mg5LTC.js";/* empty css            */const ge={class:"mb-6"},fe={class:"mb-8"},xe={class:"flex items-center justify-between max-w-4xl mx-auto"},ye={key:0,class:"w-24 h-1 mx-4 bg-gray-300"},he={class:"bg-white rounded-lg shadow p-6 max-w-5xl mx-auto"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},_e=["value"],we={class:"flex space-x-2"},He=["value"],Ce=["min"],Se=["min"],Ve={key:0,class:"mt-4 p-4 bg-blue-50 rounded-lg"},Ne={class:"text-sm text-blue-800"},$e={key:0,class:"text-center py-8 text-gray-500"},Ae={key:1,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ie=["onClick"],De={class:"flex items-center justify-between mb-2"},Re={class:"font-bold text-lg"},Ue={key:0,class:"text-blue-600 text-2xl"},Be={class:"text-sm text-gray-600"},qe={class:"text-sm text-gray-500"},Ee={class:"text-lg font-bold text-blue-600 mt-2"},Pe={key:2,class:"mt-6 p-4 bg-green-50 rounded-lg"},je={class:"text-sm text-green-800"},Te={class:"mb-4"},Me={class:"flex space-x-2"},Fe=["value"],Oe={key:0,class:"space-y-2"},ze=["onClick"],Le={key:1,class:"text-center py-8 text-gray-400"},Ge={class:"space-y-6"},Je={class:"p-4 bg-gray-50 rounded-lg"},Ke={class:"grid grid-cols-2 gap-3 text-sm"},Qe={class:"ml-2 font-medium"},We={class:"ml-2 font-medium"},Xe={class:"ml-2 font-medium"},Ye={class:"ml-2 font-medium"},Ze={class:"ml-2 font-medium"},et={class:"ml-2 font-medium"},tt={class:"p-4 bg-gray-50 rounded-lg"},st={class:"font-bold text-lg mb-3"},lt={class:"space-y-2"},at={class:"font-bold text-blue-600"},ot={key:0,class:"p-4 bg-gray-50 rounded-lg"},nt={class:"font-bold text-lg mb-3"},rt={class:"space-y-1"},it={class:"p-6 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg text-white"},ut={class:"flex justify-between items-center"},dt={class:"text-4xl font-bold"},pt={key:0,class:"mt-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},vt={class:"mt-8 flex items-center justify-between"},ct={key:1},bt={class:"flex space-x-3"},mt={class:"grid grid-cols-2 gap-4"},gt={class:"col-span-2"},Vt={__name:"Create",setup(ft){const G=de(),J=pe(),A=ve(),y=ce(),K=be(),p=v(1),j=["InformaciÃ³n","Habitaciones","HuÃ©spedes","Resumen"],I=v(!1),N=v(null),l=v({id_hotel:"",id_huesped:"",fecha_entrada:"",fecha_salida:"",adultos:1,ninos:0,habitaciones:[],huespedes_adicionales:[]}),C=v(""),D=v(!1),k=v([]),R=v(!1),_=v(""),S=v(!1),U=v(!1),d=v({nombre:"",apellido:"",ci:"",telefono:"",email:""}),T=V(()=>new Date().toISOString().split("T")[0]),w=V(()=>{if(!l.value.fecha_entrada||!l.value.fecha_salida)return 0;const a=new Date(l.value.fecha_entrada),e=new Date(l.value.fecha_salida);return Math.ceil((e-a)/(1e3*60*60*24))}),Q=V(()=>y.huespedesActivos.filter(a=>a.id!==l.value.id_huesped&&!l.value.huespedes_adicionales.includes(a.id))),M=V(()=>{switch(p.value){case 1:return l.value.id_hotel&&l.value.id_huesped&&l.value.fecha_entrada&&l.value.fecha_salida&&w.value>0;case 2:return l.value.habitaciones.length>0;case 3:return!0;default:return!0}}),W=V(()=>{let a=0;return l.value.habitaciones.forEach(e=>{const s=k.value.find(c=>c.id===e.id_habitacion);s&&(a+=s.tipo.precio_base*w.value)}),a}),X=async()=>{if(C.value){D.value=!0;try{const a=await y.buscarPorCi(C.value);l.value.id_huesped=a.id,C.value=""}catch{alert("HuÃ©sped no encontrado")}finally{D.value=!1}}},Y=async()=>{if(!l.value.id_hotel){alert("Selecciona un hotel primero");return}R.value=!0;try{k.value=await K.fetchHabitacionesDisponibles(l.value.id_hotel)}catch{alert("Error al cargar habitaciones")}finally{R.value=!1}},F=a=>l.value.habitaciones.some(e=>e.id_habitacion===a),Z=a=>{const e=l.value.habitaciones.findIndex(s=>s.id_habitacion===a.id);e!==-1?l.value.habitaciones.splice(e,1):l.value.habitaciones.push({id_habitacion:a.id})},ee=()=>{_.value&&(l.value.huespedes_adicionales.includes(_.value)||l.value.huespedes_adicionales.push(_.value),_.value="")},te=a=>{l.value.huespedes_adicionales.splice(a,1)},se=async()=>{if(!d.value.nombre||!d.value.apellido||!d.value.ci){alert("Completa los campos obligatorios");return}U.value=!0;try{const a=await y.createHuesped(d.value);l.value.id_huesped=a.data.id,S.value=!1,d.value={nombre:"",apellido:"",ci:"",telefono:"",email:""}}catch{alert("Error al crear huÃ©sped")}finally{U.value=!1}},le=()=>{if(M.value){if(p.value===2&&l.value.habitaciones.length===0){alert("Debes seleccionar al menos una habitaciÃ³n");return}p.value++}},ae=async()=>{I.value=!0,N.value=null;try{await J.createReserva(l.value),G.push("/reservas")}catch(a){N.value=a.response?.data?.message||"Error al crear reserva"}finally{I.value=!1}},oe=()=>A.hoteles.find(e=>e.id===l.value.id_hotel)?.nombre||"",ne=()=>{const a=y.huespedes.find(e=>e.id===l.value.id_huesped);return a?`${a.nombre} ${a.apellido}`:""},O=a=>{const e=y.huespedes.find(s=>s.id===a);return e?`${e.nombre} ${e.apellido}`:""},re=a=>{const e=k.value.find(s=>s.id===a);return e?`HabitaciÃ³n ${e.numero} - ${e.tipo?.nombre}`:""},ie=a=>{const e=k.value.find(s=>s.id===a);return e?e.tipo.precio_base*w.value:0},z=a=>a?new Date(a).toLocaleDateString("es-BO",{day:"2-digit",month:"long",year:"numeric"}):"",B=a=>new Intl.NumberFormat("es-BO",{style:"currency",currency:"BOB"}).format(a);return ue(()=>{A.fetchHoteles(),y.fetchHuespedes()}),(a,e)=>(n(),r("div",null,[t("div",ge,[t("button",{onClick:e[0]||(e[0]=s=>a.$router.back()),class:"text-blue-600 hover:text-blue-800 mb-4"}," â† Volver "),e[19]||(e[19]=t("h1",{class:"text-3xl font-bold text-gray-800"},"Nueva Reserva",-1)),e[20]||(e[20]=t("p",{class:"text-gray-600 mt-1"},"Crea una nueva reserva paso a paso",-1))]),t("div",fe,[t("div",xe,[(n(),r(f,null,x(j,(s,c)=>t("div",{key:c,class:"flex items-center"},[t("div",{class:P(["w-10 h-10 rounded-full flex items-center justify-center font-bold",p.value>=c+1?"bg-blue-600 text-white":"bg-gray-300 text-gray-600"])},o(c+1),3),t("span",{class:P(["ml-2 text-sm font-medium",p.value>=c+1?"text-blue-600":"text-gray-500"])},o(s),3),c<j.length-1?(n(),r("div",ye)):H("",!0)])),64))])]),t("div",he,[i(t("div",null,[e[32]||(e[32]=t("h2",{class:"text-2xl font-bold text-gray-800 mb-6"},"Paso 1: InformaciÃ³n BÃ¡sica",-1)),t("div",ke,[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Hotel "),t("span",{class:"text-red-500"},"*")],-1)),i(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.id_hotel=s),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[e[21]||(e[21]=t("option",{value:""},"Selecciona un hotel",-1)),(n(!0),r(f,null,x(L(A).hotelesActivos,s=>(n(),r("option",{key:s.id,value:s.id},o(s.nombre),9,_e))),128))],512),[[q,l.value.id_hotel]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Buscar HuÃ©sped por CI ",-1)),t("div",we,[i(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>C.value=s),type:"text",placeholder:"Ingresa CI",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[m,C.value]]),h(g,{onClick:X,loading:D.value},{default:b(()=>[...e[23]||(e[23]=[u(" ðŸ” ",-1)])]),_:1},8,["loading"])])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" HuÃ©sped Principal "),t("span",{class:"text-red-500"},"*")],-1)),i(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.id_huesped=s),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[e[25]||(e[25]=t("option",{value:""},"Selecciona un huÃ©sped",-1)),(n(!0),r(f,null,x(L(y).huespedesActivos,s=>(n(),r("option",{key:s.id,value:s.id},o(s.nombre)+" "+o(s.apellido)+" - "+o(s.ci),9,He))),128))],512),[[q,l.value.id_huesped]]),t("button",{type:"button",onClick:e[4]||(e[4]=s=>S.value=!0),class:"mt-2 text-sm text-blue-600 hover:text-blue-800"}," + Registrar nuevo huÃ©sped ")]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Fecha de Entrada "),t("span",{class:"text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>l.value.fecha_entrada=s),type:"date",required:"",min:T.value,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,8,Ce),[[m,l.value.fecha_entrada]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Fecha de Salida "),t("span",{class:"text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>l.value.fecha_salida=s),type:"date",required:"",min:l.value.fecha_entrada||T.value,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,8,Se),[[m,l.value.fecha_salida]])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Adultos "),t("span",{class:"text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>l.value.adultos=s),type:"number",min:"1",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[m,l.value.adultos,void 0,{number:!0}]])]),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," NiÃ±os ",-1)),i(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>l.value.ninos=s),type:"number",min:"0",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[m,l.value.ninos,void 0,{number:!0}]])])]),w.value>0?(n(),r("div",Ve,[t("p",Ne,[e[31]||(e[31]=u(" ðŸ“… Total de noches: ",-1)),t("strong",null,o(w.value),1)])])):H("",!0)],512),[[$,p.value===1]]),i(t("div",null,[e[36]||(e[36]=t("h2",{class:"text-2xl font-bold text-gray-800 mb-6"},"Paso 2: Seleccionar Habitaciones",-1)),h(g,{onClick:Y,loading:R.value,class:"mb-4"},{default:b(()=>[...e[33]||(e[33]=[u(" ðŸ”„ Cargar Habitaciones Disponibles ",-1)])]),_:1},8,["loading"]),k.value.length===0?(n(),r("div",$e," Haz clic en el botÃ³n para cargar habitaciones disponibles ")):(n(),r("div",Ae,[(n(!0),r(f,null,x(k.value,s=>(n(),r("div",{key:s.id,onClick:c=>Z(s),class:P(["border-2 rounded-lg p-4 cursor-pointer transition-all",F(s.id)?"border-blue-600 bg-blue-50":"border-gray-300 hover:border-blue-400"])},[t("div",De,[t("h3",Re,"ðŸšª "+o(s.numero),1),F(s.id)?(n(),r("span",Ue,"âœ“")):H("",!0)]),t("p",Be,o(s.tipo?.nombre),1),t("p",qe,"Capacidad: "+o(s.tipo?.capacidad)+" personas",1),t("p",Ee,o(B(s.tipo?.precio_base))+"/noche ",1)],10,Ie))),128))])),l.value.habitaciones.length>0?(n(),r("div",Pe,[t("p",je,[e[34]||(e[34]=u(" âœ“ ",-1)),t("strong",null,o(l.value.habitaciones.length),1),e[35]||(e[35]=u(" habitaciÃ³n(es) seleccionada(s) ",-1))])])):H("",!0)],512),[[$,p.value===2]]),i(t("div",null,[e[42]||(e[42]=t("h2",{class:"text-2xl font-bold text-gray-800 mb-6"},"Paso 3: HuÃ©spedes Adicionales (Opcional)",-1)),e[43]||(e[43]=t("p",{class:"text-gray-600 mb-4"},"Agrega otros huÃ©spedes que se alojarÃ¡n en esta reserva",-1)),t("div",Te,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Seleccionar huÃ©sped ",-1)),t("div",Me,[i(t("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>_.value=s),class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[e[37]||(e[37]=t("option",{value:""},"Selecciona un huÃ©sped",-1)),(n(!0),r(f,null,x(Q.value,s=>(n(),r("option",{key:s.id,value:s.id},o(s.nombre)+" "+o(s.apellido)+" - "+o(s.ci),9,Fe))),128))],512),[[q,_.value]]),h(g,{onClick:ee},{default:b(()=>[...e[38]||(e[38]=[u(" + Agregar ",-1)])]),_:1})])]),l.value.huespedes_adicionales.length>0?(n(),r("div",Oe,[e[40]||(e[40]=t("h3",{class:"font-medium text-gray-700 mb-3"},"HuÃ©spedes agregados:",-1)),(n(!0),r(f,null,x(l.value.huespedes_adicionales,(s,c)=>(n(),r("div",{key:c,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[t("span",null,"ðŸ‘¤ "+o(O(s)),1),t("button",{onClick:xt=>te(c),class:"text-red-600 hover:text-red-800",title:"Remover"}," âŒ ",8,ze)]))),128))])):(n(),r("div",Le,[...e[41]||(e[41]=[t("p",{class:"text-lg mb-2"},"ðŸ‘¥",-1),t("p",null,"No hay huÃ©spedes adicionales agregados",-1),t("p",{class:"text-sm mt-2"},"Puedes continuar sin agregar mÃ¡s huÃ©spedes",-1)])]))],512),[[$,p.value===3]]),i(t("div",null,[e[52]||(e[52]=t("h2",{class:"text-2xl font-bold text-gray-800 mb-6"},"Paso 4: Resumen de la Reserva",-1)),t("div",Ge,[t("div",Je,[e[50]||(e[50]=t("h3",{class:"font-bold text-lg mb-3"},"ðŸ“‹ InformaciÃ³n BÃ¡sica",-1)),t("div",Ke,[t("div",null,[e[44]||(e[44]=t("span",{class:"text-gray-600"},"Hotel:",-1)),t("span",Qe,o(oe()),1)]),t("div",null,[e[45]||(e[45]=t("span",{class:"text-gray-600"},"HuÃ©sped:",-1)),t("span",We,o(ne()),1)]),t("div",null,[e[46]||(e[46]=t("span",{class:"text-gray-600"},"Entrada:",-1)),t("span",Xe,o(z(l.value.fecha_entrada)),1)]),t("div",null,[e[47]||(e[47]=t("span",{class:"text-gray-600"},"Salida:",-1)),t("span",Ye,o(z(l.value.fecha_salida)),1)]),t("div",null,[e[48]||(e[48]=t("span",{class:"text-gray-600"},"Noches:",-1)),t("span",Ze,o(w.value),1)]),t("div",null,[e[49]||(e[49]=t("span",{class:"text-gray-600"},"Personas:",-1)),t("span",et,o(l.value.adultos+l.value.ninos)+" ("+o(l.value.adultos)+" adultos, "+o(l.value.ninos)+" niÃ±os)",1)])])]),t("div",tt,[t("h3",st,"ðŸ¨ Habitaciones Seleccionadas ("+o(l.value.habitaciones.length)+")",1),t("div",lt,[(n(!0),r(f,null,x(l.value.habitaciones,s=>(n(),r("div",{key:s.id_habitacion,class:"flex justify-between items-center text-sm bg-white p-3 rounded"},[t("span",null,o(re(s.id_habitacion)),1),t("span",at,o(B(ie(s.id_habitacion))),1)]))),128))])]),l.value.huespedes_adicionales.length>0?(n(),r("div",ot,[t("h3",nt,"ðŸ‘¥ HuÃ©spedes Adicionales ("+o(l.value.huespedes_adicionales.length)+")",1),t("ul",rt,[(n(!0),r(f,null,x(l.value.huespedes_adicionales,s=>(n(),r("li",{key:s,class:"text-sm"}," â€¢ "+o(O(s)),1))),128))])])):H("",!0),t("div",it,[t("div",ut,[e[51]||(e[51]=t("div",null,[t("p",{class:"text-sm opacity-90"},"Total Estimado de la Reserva"),t("p",{class:"text-xs opacity-75 mt-1"},"(Solo habitaciones, sin servicios adicionales)")],-1)),t("p",dt,o(B(W.value)),1)])])])],512),[[$,p.value===4]]),N.value?(n(),r("div",pt," âš ï¸ "+o(N.value),1)):H("",!0),t("div",vt,[p.value>1?(n(),E(g,{key:0,type:"button",variant:"secondary",onClick:e[10]||(e[10]=s=>p.value--)},{default:b(()=>[...e[53]||(e[53]=[u(" â† Anterior ",-1)])]),_:1})):(n(),r("div",ct)),t("div",bt,[h(g,{type:"button",variant:"secondary",onClick:e[11]||(e[11]=s=>a.$router.back())},{default:b(()=>[...e[54]||(e[54]=[u(" Cancelar ",-1)])]),_:1}),p.value<4?(n(),E(g,{key:0,type:"button",onClick:le,disabled:!M.value},{default:b(()=>[...e[55]||(e[55]=[u(" Siguiente â†’ ",-1)])]),_:1},8,["disabled"])):(n(),E(g,{key:1,type:"button",onClick:ae,loading:I.value},{default:b(()=>[...e[56]||(e[56]=[u(" âœ“ Crear Reserva ",-1)])]),_:1},8,["loading"]))])])]),h(me,{show:S.value,onClose:e[18]||(e[18]=s=>S.value=!1),title:"Registrar Nuevo HuÃ©sped",size:"lg"},{footer:b(()=>[h(g,{variant:"secondary",onClick:e[17]||(e[17]=s=>S.value=!1)},{default:b(()=>[...e[62]||(e[62]=[u("Cancelar",-1)])]),_:1}),h(g,{onClick:se,loading:U.value},{default:b(()=>[...e[63]||(e[63]=[u("Guardar HuÃ©sped",-1)])]),_:1},8,["loading"])]),default:b(()=>[t("div",mt,[t("div",null,[e[57]||(e[57]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nombre *",-1)),i(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>d.value.nombre=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Nombre"},null,512),[[m,d.value.nombre]])]),t("div",null,[e[58]||(e[58]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Apellido *",-1)),i(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>d.value.apellido=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Apellido"},null,512),[[m,d.value.apellido]])]),t("div",null,[e[59]||(e[59]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"CI *",-1)),i(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>d.value.ci=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"CÃ©dula de Identidad"},null,512),[[m,d.value.ci]])]),t("div",null,[e[60]||(e[60]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"TelÃ©fono",-1)),i(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>d.value.telefono=s),type:"text",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"TelÃ©fono"},null,512),[[m,d.value.telefono]])]),t("div",gt,[e[61]||(e[61]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email",-1)),i(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>d.value.email=s),type:"email",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"correo@ejemplo.com"},null,512),[[m,d.value.email]])])])]),_:1},8,["show"])]))}};export{Vt as default};
