import{u as G,r as u,g as O,h as J,c as d,a as t,i as m,k as K,d as E,l as p,m as a,e as k,p as h,F as P,A as S,b as Q,t as l,j as W,q as X,o as r,s as i,n as Y}from"./app-DWQ7THlv.js";import{u as Z}from"./habitaciones-BXYPAQ8z.js";import{u as ee}from"./hoteles-Cj_n2tFk.js";import{_ as te}from"./Table-Cma2KXjz.js";import{_ as g}from"./Button-AgtSY3Ng.js";import{M}from"./Modal-B7Mg5LTC.js";/* empty css            */const oe={class:"flex items-center justify-between mb-6"},se={class:"bg-white rounded-lg shadow p-4 mb-6"},ae={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},le=["value"],ie=["value"],ne={class:"flex items-end"},re={class:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6"},de={class:"bg-white rounded-lg shadow p-4 text-center"},ue={class:"text-3xl font-bold text-green-600"},me={class:"bg-white rounded-lg shadow p-4 text-center"},ce={class:"text-3xl font-bold text-blue-600"},pe={class:"bg-white rounded-lg shadow p-4 text-center"},ve={class:"text-3xl font-bold text-yellow-600"},be={class:"bg-white rounded-lg shadow p-4 text-center"},ge={class:"text-3xl font-bold text-orange-600"},fe={class:"bg-white rounded-lg shadow p-4 text-center"},xe={class:"text-3xl font-bold text-gray-600"},ye={key:0,class:"flex items-center space-x-2"},Ee=["onClick"],Ce=["onClick"],we=["onClick"],ke={class:"text-gray-700 mb-4"},he={class:"text-gray-700"},Me={__name:"Index",setup(Ae){const T=X(),C=G(),v=Z(),D=ee(),n=u({id_hotel:"",id_piso:"",estado:""}),A=u([]),f=u(!1),x=u(!1),b=u(null),w=u(""),I=u(!1),N=u(!1),V=[{key:"numero",label:"NÃºmero"},{key:"hotel",label:"Hotel"},{key:"piso",label:"Piso"},{key:"tipo",label:"Tipo"},{key:"precio",label:"Precio/Noche"},{key:"estado",label:"Estado"}],H=O(()=>n.value.id_hotel?A.value.filter(s=>s.id_hotel===n.value.id_hotel):A.value),y=O(()=>{const s=v.habitaciones;return{total:s.length,disponibles:s.filter(e=>e.estado==="DISPONIBLE").length,ocupadas:s.filter(e=>e.estado==="OCUPADA").length,reservadas:s.filter(e=>e.estado==="RESERVADA").length,mantenimiento:s.filter(e=>e.estado==="MANTENIMIENTO").length}}),c=async()=>{try{await v.fetchHabitaciones(n.value)}catch(s){console.error("Error al cargar habitaciones:",s)}},R=async()=>{try{const s=await W.get("/pisos");s.data.success&&(A.value=s.data.data)}catch(s){console.error("Error al cargar pisos:",s)}},$=()=>{n.value={id_hotel:"",id_piso:"",estado:""},c()},B=s=>{T.push(`/habitaciones/${s}/editar`)},L=s=>{b.value=s,w.value=s.estado,f.value=!0},U=async()=>{I.value=!0;try{await v.cambiarEstado(b.value.id,w.value),f.value=!1,await c()}catch{alert("Error al cambiar estado")}finally{I.value=!1}},F=s=>{b.value=s,x.value=!0},j=async()=>{N.value=!0;try{await v.deleteHabitacion(b.value.id),x.value=!1,await c()}catch{alert("Error al eliminar habitaciÃ³n")}finally{N.value=!1}},q=s=>({DISPONIBLE:"bg-green-100 text-green-800",OCUPADA:"bg-blue-100 text-blue-800",RESERVADA:"bg-yellow-100 text-yellow-800",MANTENIMIENTO:"bg-orange-100 text-orange-800",INACTIVA:"bg-gray-100 text-gray-800",DEMOLIDA:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",z=s=>new Intl.NumberFormat("es-BO",{style:"currency",currency:"BOB"}).format(s);return J(()=>{D.fetchHoteles(),R(),c()}),(s,e)=>(r(),d("div",null,[t("div",oe,[e[10]||(e[10]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-800"},"Habitaciones"),t("p",{class:"text-gray-600 mt-1"},"Administra todas las habitaciones del sistema")],-1)),p(C).hasPermission("crear_habitaciones")?(r(),K(g,{key:0,onClick:e[0]||(e[0]=o=>s.$router.push("/habitaciones/crear"))},{default:a(()=>[...e[9]||(e[9]=[i(" âž• Nueva HabitaciÃ³n ",-1)])]),_:1})):E("",!0)]),t("div",se,[t("div",ae,[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Hotel",-1)),k(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.id_hotel=o),onChange:c,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[e[11]||(e[11]=t("option",{value:""},"Todos",-1)),(r(!0),d(P,null,S(p(D).hoteles,o=>(r(),d("option",{key:o.id,value:o.id},l(o.nombre),9,le))),128))],544),[[h,n.value.id_hotel]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Piso",-1)),k(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>n.value.id_piso=o),onChange:c,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[e[13]||(e[13]=t("option",{value:""},"Todos",-1)),(r(!0),d(P,null,S(H.value,o=>(r(),d("option",{key:o.id,value:o.id}," Piso "+l(o.numero),9,ie))),128))],544),[[h,n.value.id_piso]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Estado",-1)),k(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>n.value.estado=o),onChange:c,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[...e[15]||(e[15]=[Q('<option value="">Todos</option><option value="DISPONIBLE">Disponible</option><option value="OCUPADA">Ocupada</option><option value="RESERVADA">Reservada</option><option value="MANTENIMIENTO">Mantenimiento</option><option value="INACTIVA">Inactiva</option>',6)])],544),[[h,n.value.estado]])]),t("div",ne,[m(g,{variant:"secondary",onClick:$,class:"w-full"},{default:a(()=>[...e[17]||(e[17]=[i(" ðŸ”„ Limpiar ",-1)])]),_:1})])])]),t("div",re,[t("div",de,[t("p",ue,l(y.value.disponibles),1),e[18]||(e[18]=t("p",{class:"text-sm text-gray-600 mt-1"},"Disponibles",-1))]),t("div",me,[t("p",ce,l(y.value.ocupadas),1),e[19]||(e[19]=t("p",{class:"text-sm text-gray-600 mt-1"},"Ocupadas",-1))]),t("div",pe,[t("p",ve,l(y.value.reservadas),1),e[20]||(e[20]=t("p",{class:"text-sm text-gray-600 mt-1"},"Reservadas",-1))]),t("div",be,[t("p",ge,l(y.value.mantenimiento),1),e[21]||(e[21]=t("p",{class:"text-sm text-gray-600 mt-1"},"Mantenimiento",-1))]),t("div",fe,[t("p",xe,l(y.value.total),1),e[22]||(e[22]=t("p",{class:"text-sm text-gray-600 mt-1"},"Total",-1))])]),m(te,{columns:V,data:p(v).habitaciones,loading:p(v).loading},{"cell-hotel":a(({item:o})=>[i(l(o?.hotel?.nombre),1)]),"cell-piso":a(({item:o})=>[i(" Piso "+l(o?.piso?.numero),1)]),"cell-tipo":a(({item:o})=>[i(l(o?.tipo?.nombre),1)]),"cell-precio":a(({item:o})=>[i(l(z(o?.tipo?.precio_base)),1)]),"cell-estado":a(({item:o})=>[t("span",{class:Y(["px-3 py-1 rounded-full text-xs font-semibold",q(o?.estado)])},l(o?.estado),3)]),actions:a(({item:o})=>[o?(r(),d("div",ye,[p(C).hasPermission("cambiar_estado_habitaciones")?(r(),d("button",{key:0,onClick:_=>L(o),class:"text-purple-600 hover:text-purple-800",title:"Cambiar estado"}," ðŸ”„ ",8,Ee)):E("",!0),p(C).hasPermission("editar_habitaciones")?(r(),d("button",{key:1,onClick:_=>B(o.id),class:"text-yellow-600 hover:text-yellow-800",title:"Editar"}," âœï¸ ",8,Ce)):E("",!0),p(C).hasPermission("eliminar_habitaciones")?(r(),d("button",{key:2,onClick:_=>F(o),class:"text-red-600 hover:text-red-800",title:"Eliminar"}," ðŸ—‘ï¸ ",8,we)):E("",!0)])):E("",!0)]),_:1},8,["data","loading"]),m(M,{show:f.value,onClose:e[6]||(e[6]=o=>f.value=!1),title:"Cambiar Estado"},{footer:a(()=>[m(g,{variant:"secondary",onClick:e[5]||(e[5]=o=>f.value=!1)},{default:a(()=>[...e[26]||(e[26]=[i("Cancelar",-1)])]),_:1}),m(g,{onClick:U,loading:I.value},{default:a(()=>[...e[27]||(e[27]=[i("Cambiar",-1)])]),_:1},8,["loading"])]),default:a(()=>[t("div",null,[t("p",ke,[e[23]||(e[23]=i(" HabitaciÃ³n: ",-1)),t("strong",null,l(b.value?.numero),1)]),e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nuevo Estado",-1)),k(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>w.value=o),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[...e[24]||(e[24]=[t("option",{value:"DISPONIBLE"},"Disponible",-1),t("option",{value:"OCUPADA"},"Ocupada",-1),t("option",{value:"RESERVADA"},"Reservada",-1),t("option",{value:"MANTENIMIENTO"},"Mantenimiento",-1),t("option",{value:"INACTIVA"},"Inactiva",-1)])],512),[[h,w.value]])])]),_:1},8,["show"]),m(M,{show:x.value,onClose:e[8]||(e[8]=o=>x.value=!1),title:"Confirmar eliminaciÃ³n"},{footer:a(()=>[m(g,{variant:"secondary",onClick:e[7]||(e[7]=o=>x.value=!1)},{default:a(()=>[...e[30]||(e[30]=[i("Cancelar",-1)])]),_:1}),m(g,{variant:"danger",onClick:j,loading:N.value},{default:a(()=>[...e[31]||(e[31]=[i("Confirmar",-1)])]),_:1},8,["loading"])]),default:a(()=>[t("p",he,[e[28]||(e[28]=i(" Â¿EstÃ¡s seguro de marcar como DEMOLIDA la habitaciÃ³n ",-1)),t("strong",null,l(b.value?.numero),1),e[29]||(e[29]=i("? ",-1))])]),_:1},8,["show"])]))}};export{Me as default};
