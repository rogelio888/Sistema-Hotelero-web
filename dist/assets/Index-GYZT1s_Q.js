import{r as c,h as N,c as u,a,i as f,m as i,y as B,e as y,v as x,d as h,t as n,j as k,o as m,s as v,w as F}from"./index-CTzTmT_K.js";import{_ as I}from"./Table-fkUJsl3I.js";const M={class:"p-6"},V={class:"flex justify-between items-center mb-6"},$={class:"bg-white rounded-lg shadow p-4 mb-6"},A={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},D={class:"bg-white rounded-lg shadow overflow-hidden"},O={class:"font-medium text-gray-900"},S={class:"text-sm text-gray-500"},j={key:0,class:"flex items-center justify-end space-x-2"},P=["onClick"],R={key:1,class:"text-sm text-gray-400 italic"},H={key:0,class:"px-6 py-4 border-t border-gray-200 flex items-center justify-between"},T={class:"text-sm text-gray-500"},U={class:"flex space-x-2"},q=["disabled"],z=["disabled"],Q={__name:"Index",setup(G){const g=c([]),b=c(!1),s=c({current_page:1,last_page:1,from:0,to:0,total:0}),l=c({fecha_inicio:"",fecha_fin:""}),C=[{key:"id",label:"ID",sortable:!0},{key:"reserva",label:"Reserva"},{key:"servicio",label:"Servicio"},{key:"cantidad",label:"Cantidad",sortable:!0},{key:"subtotal",label:"Subtotal",sortable:!0},{key:"fecha",label:"Fecha",sortable:!0}],w=o=>new Intl.NumberFormat("es-BO",{style:"currency",currency:"BOB"}).format(o),d=async(o=1)=>{b.value=!0;try{const e={page:o};l.value.fecha_inicio&&(e.fecha_inicio=l.value.fecha_inicio),l.value.fecha_fin&&(e.fecha_fin=l.value.fecha_fin);const r=await k.get("/consumos",{params:e});g.value=r.data.data.data,s.value={current_page:r.data.data.current_page,last_page:r.data.data.last_page,from:r.data.data.from,to:r.data.data.to,total:r.data.data.total}}catch(e){console.error("Error al cargar consumos:",e),alert("Error al cargar los consumos")}finally{b.value=!1}},p=o=>{o>=1&&o<=s.value.last_page&&d(o)},_=async o=>{if(confirm("Â¿EstÃ¡s seguro de eliminar este consumo?"))try{await k.delete(`/consumos/${o.id}`),alert("Consumo eliminado exitosamente"),d()}catch(e){console.error("Error al eliminar consumo:",e),alert(e.response?.data?.message||"Error al eliminar el consumo")}},E=o=>["CONFIRMADA","EN_PROCESO"].includes(o.reserva?.estado);return N(()=>{d()}),(o,e)=>{const r=B("router-link");return m(),u("div",M,[a("div",V,[e[5]||(e[5]=a("h1",{class:"text-2xl font-bold text-gray-800"},"Consumos",-1)),f(r,{to:"/consumos/crear",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"},{default:i(()=>[...e[4]||(e[4]=[v(" + Nuevo Consumo ",-1)])]),_:1})]),a("div",$,[a("div",A,[a("div",null,[e[6]||(e[6]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Fecha Inicio",-1)),y(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.fecha_inicio=t),type:"date",onChange:d,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,544),[[x,l.value.fecha_inicio]])]),a("div",null,[e[7]||(e[7]=a("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Fecha Fin",-1)),y(a("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.fecha_fin=t),type:"date",onChange:d,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,544),[[x,l.value.fecha_fin]])])])]),a("div",D,[f(I,{columns:C,data:g.value,loading:b.value,actions:!0,onDelete:_},{"cell-reserva":i(({item:t})=>[a("div",null,[a("div",O," Hab. "+n(t.reserva?.habitacion?.[0]?.numero||"N/A"),1),a("div",S,n(t.reserva?.huesped?.nombre||"HuÃ©sped desconocido"),1)])]),"cell-servicio":i(({item:t})=>[v(n(t.servicio?.nombre||"N/A"),1)]),"cell-subtotal":i(({item:t})=>[v(n(w(t.subtotal)),1)]),actions:i(({item:t})=>[t&&E(t)?(m(),u("div",j,[f(r,{to:`/consumos/editar/${t.id}`,class:"text-blue-500 hover:text-blue-600 p-1",title:"Editar"},{default:i(()=>[...e[8]||(e[8]=[v(" âœï¸ ",-1)])]),_:1},8,["to"]),a("button",{onClick:F(J=>_(t),["stop"]),class:"text-red-500 hover:text-red-600 p-1",title:"Eliminar"}," ðŸ—‘ï¸ ",8,P)])):t?(m(),u("div",R," Reserva "+n(t.reserva?.estado),1)):h("",!0)]),_:1},8,["data","loading"]),s.value.total>0?(m(),u("div",H,[a("div",T," Mostrando "+n(s.value.from)+" a "+n(s.value.to)+" de "+n(s.value.total)+" resultados ",1),a("div",U,[a("button",{onClick:e[2]||(e[2]=t=>p(s.value.current_page-1)),disabled:s.value.current_page<=1,class:"px-3 py-1 border border-gray-300 rounded-md text-sm disabled:opacity-50 hover:bg-gray-50"}," Anterior ",8,q),a("button",{onClick:e[3]||(e[3]=t=>p(s.value.current_page+1)),disabled:s.value.current_page>=s.value.last_page,class:"px-3 py-1 border border-gray-300 rounded-md text-sm disabled:opacity-50 hover:bg-gray-50"}," Siguiente ",8,z)])])):h("",!0)])])}}};export{Q as default};
