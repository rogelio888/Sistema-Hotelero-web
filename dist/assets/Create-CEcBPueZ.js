import{C as de,B as pe,r as p,g as N,h as ce,c as r,a as s,i as h,F as f,A as y,e as i,d as H,D as $,s as u,l as G,p as E,v as m,m as b,t as o,k as P,q as ve,o as n,n as j}from"./index-CTzTmT_K.js";import{u as be}from"./hoteles-UglgslUa.js";import{u as me}from"./huespedes-BqSkQYlh.js";import{_ as g}from"./Button-Dd-4xSWI.js";import{M as ge}from"./Modal-ClueKbjA.js";const fe={class:"mb-6"},ye={class:"mb-8"},xe={class:"flex items-center justify-between max-w-4xl mx-auto"},he={key:0,class:"w-24 h-1 mx-4 bg-gray-300"},ke={class:"bg-white rounded-lg shadow p-6 max-w-5xl mx-auto"},_e={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},we=["value"],He={class:"flex space-x-2"},Ce=["value"],Se=["min"],Ne=["min"],Ve={key:0,class:"mt-4 p-4 bg-blue-50 rounded-lg"},$e={class:"text-sm text-blue-800"},Ae={key:0,class:"text-center py-8 text-gray-500"},De={key:1,class:"text-center py-8 text-red-500 bg-red-50 rounded-lg border border-red-100"},Ie={key:2,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Re=["onClick"],Ue={class:"flex items-center justify-between mb-2"},Be={class:"font-bold text-lg"},qe={key:0,class:"text-blue-600 text-2xl"},Ee={class:"text-sm text-gray-600"},Pe={class:"text-sm text-gray-500"},je={class:"text-lg font-bold text-blue-600 mt-2"},Te={key:3,class:"mt-6 p-4 bg-green-50 rounded-lg"},Me={class:"text-sm text-green-800"},ze={class:"mb-4"},Fe={class:"flex space-x-2"},Oe=["value"],Le={key:0,class:"space-y-2"},Ge=["onClick"],Je={key:1,class:"text-center py-8 text-gray-400"},Ke={class:"space-y-6"},Qe={class:"p-4 bg-gray-50 rounded-lg"},We={class:"grid grid-cols-2 gap-3 text-sm"},Xe={class:"ml-2 font-medium"},Ye={class:"ml-2 font-medium"},Ze={class:"ml-2 font-medium"},es={class:"ml-2 font-medium"},ss={class:"ml-2 font-medium"},ts={class:"ml-2 font-medium"},ls={class:"p-4 bg-gray-50 rounded-lg"},as={class:"font-bold text-lg mb-3"},os={class:"space-y-2"},ns={class:"font-bold text-blue-600"},rs={key:0,class:"p-4 bg-gray-50 rounded-lg"},is={class:"font-bold text-lg mb-3"},us={class:"space-y-1"},ds={class:"p-6 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg text-white"},ps={class:"flex justify-between items-center"},cs={class:"text-4xl font-bold"},vs={key:0,class:"mt-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg"},bs={class:"mt-8 flex items-center justify-between"},ms={key:1},gs={class:"flex space-x-3"},fs={class:"grid grid-cols-2 gap-4"},ys={class:"col-span-2"},Ss={__name:"Create",setup(xs){const J=ve(),K=de(),A=be(),x=me(),Q=pe(),c=p(1),T=["InformaciÃ³n","Habitaciones","HuÃ©spedes","Resumen"],D=p(!1),V=p(null),l=p({id_hotel:"",id_huesped:"",fecha_entrada:"",fecha_salida:"",adultos:1,ninos:0,habitaciones:[],huespedes_adicionales:[]}),C=p(""),I=p(!1),k=p([]),R=p(!1),U=p(!1),_=p(""),S=p(!1),B=p(!1),d=p({nombre:"",apellido:"",ci:"",telefono:"",email:""}),M=N(()=>new Date().toISOString().split("T")[0]),w=N(()=>{if(!l.value.fecha_entrada||!l.value.fecha_salida)return 0;const a=new Date(l.value.fecha_entrada),e=new Date(l.value.fecha_salida);return Math.ceil((e-a)/(1e3*60*60*24))}),W=N(()=>x.huespedesActivos.filter(a=>a.id!==l.value.id_huesped&&!l.value.huespedes_adicionales.includes(a.id))),z=N(()=>{switch(c.value){case 1:return l.value.id_hotel&&l.value.id_huesped&&l.value.fecha_entrada&&l.value.fecha_salida&&w.value>0;case 2:return l.value.habitaciones.length>0;case 3:return!0;default:return!0}}),X=N(()=>{let a=0;return l.value.habitaciones.forEach(e=>{const t=k.value.find(v=>v.id===e.id_habitacion);t&&(a+=t.tipo.precio_base*w.value)}),a}),Y=async()=>{if(C.value){I.value=!0;try{const a=await x.buscarPorCi(C.value);l.value.id_huesped=a.id,C.value=""}catch{alert("HuÃ©sped no encontrado")}finally{I.value=!1}}},Z=async()=>{if(!l.value.id_hotel){alert("Selecciona un hotel primero");return}R.value=!0,U.value=!1;try{k.value=await Q.fetchHabitacionesDisponibles(l.value.id_hotel),U.value=!0}catch(a){console.error(a),alert("Error al cargar habitaciones")}finally{R.value=!1}},F=a=>l.value.habitaciones.some(e=>e.id_habitacion===a),ee=a=>{const e=l.value.habitaciones.findIndex(t=>t.id_habitacion===a.id);e!==-1?l.value.habitaciones.splice(e,1):l.value.habitaciones.push({id_habitacion:a.id})},se=()=>{_.value&&(l.value.huespedes_adicionales.includes(_.value)||l.value.huespedes_adicionales.push(_.value),_.value="")},te=a=>{l.value.huespedes_adicionales.splice(a,1)},le=async()=>{if(!d.value.nombre||!d.value.apellido||!d.value.ci){alert("Completa los campos obligatorios");return}B.value=!0;try{const a=await x.createHuesped(d.value);l.value.id_huesped=a.data.id,S.value=!1,d.value={nombre:"",apellido:"",ci:"",telefono:"",email:""}}catch{alert("Error al crear huÃ©sped")}finally{B.value=!1}},ae=()=>{if(z.value){if(c.value===2&&l.value.habitaciones.length===0){alert("Debes seleccionar al menos una habitaciÃ³n");return}c.value++}},oe=async()=>{D.value=!0,V.value=null;try{await K.createReserva(l.value),J.push("/reservas")}catch(a){V.value=a.response?.data?.message||"Error al crear reserva"}finally{D.value=!1}},ne=()=>A.hoteles.find(e=>e.id===l.value.id_hotel)?.nombre||"",re=()=>{const a=x.huespedes.find(e=>e.id===l.value.id_huesped);return a?`${a.nombre} ${a.apellido}`:""},O=a=>{const e=x.huespedes.find(t=>t.id===a);return e?`${e.nombre} ${e.apellido}`:""},ie=a=>{const e=k.value.find(t=>t.id===a);return e?`HabitaciÃ³n ${e.numero} - ${e.tipo?.nombre}`:""},ue=a=>{const e=k.value.find(t=>t.id===a);return e?e.tipo.precio_base*w.value:0},L=a=>a?new Date(a).toLocaleDateString("es-BO",{day:"2-digit",month:"long",year:"numeric"}):"",q=a=>new Intl.NumberFormat("es-BO",{style:"currency",currency:"BOB"}).format(a);return ce(()=>{A.fetchHoteles(),x.fetchHuespedes()}),(a,e)=>(n(),r("div",null,[s("div",fe,[s("button",{onClick:e[0]||(e[0]=t=>a.$router.back()),class:"text-blue-600 hover:text-blue-800 mb-4"}," â† Volver "),e[19]||(e[19]=s("h1",{class:"text-3xl font-bold text-gray-800"},"Nueva Reserva",-1)),e[20]||(e[20]=s("p",{class:"text-gray-600 mt-1"},"Crea una nueva reserva paso a paso",-1))]),s("div",ye,[s("div",xe,[(n(),r(f,null,y(T,(t,v)=>s("div",{key:v,class:"flex items-center"},[s("div",{class:j(["w-10 h-10 rounded-full flex items-center justify-center font-bold",c.value>=v+1?"bg-blue-600 text-white":"bg-gray-300 text-gray-600"])},o(v+1),3),s("span",{class:j(["ml-2 text-sm font-medium",c.value>=v+1?"text-blue-600":"text-gray-500"])},o(t),3),v<T.length-1?(n(),r("div",he)):H("",!0)])),64))])]),s("div",ke,[i(s("div",null,[e[32]||(e[32]=s("h2",{class:"text-2xl font-bold text-gray-800 mb-6"},"Paso 1: InformaciÃ³n BÃ¡sica",-1)),s("div",_e,[s("div",null,[e[22]||(e[22]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Hotel "),s("span",{class:"text-red-500"},"*")],-1)),i(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.id_hotel=t),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[e[21]||(e[21]=s("option",{value:""},"Selecciona un hotel",-1)),(n(!0),r(f,null,y(G(A).hotelesActivos,t=>(n(),r("option",{key:t.id,value:t.id},o(t.nombre),9,we))),128))],512),[[E,l.value.id_hotel]])]),s("div",null,[e[24]||(e[24]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Buscar HuÃ©sped por CI ",-1)),s("div",He,[i(s("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>C.value=t),type:"text",placeholder:"Ingresa CI",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[m,C.value]]),h(g,{onClick:Y,loading:I.value},{default:b(()=>[...e[23]||(e[23]=[u(" ðŸ” ",-1)])]),_:1},8,["loading"])])]),s("div",null,[e[26]||(e[26]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" HuÃ©sped Principal "),s("span",{class:"text-red-500"},"*")],-1)),i(s("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.id_huesped=t),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[e[25]||(e[25]=s("option",{value:""},"Selecciona un huÃ©sped",-1)),(n(!0),r(f,null,y(G(x).huespedesActivos,t=>(n(),r("option",{key:t.id,value:t.id},o(t.nombre)+" "+o(t.apellido)+" - "+o(t.ci),9,Ce))),128))],512),[[E,l.value.id_huesped]]),s("button",{type:"button",onClick:e[4]||(e[4]=t=>S.value=!0),class:"mt-2 text-sm text-blue-600 hover:text-blue-800"}," + Registrar nuevo huÃ©sped ")]),s("div",null,[e[27]||(e[27]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Fecha de Entrada "),s("span",{class:"text-red-500"},"*")],-1)),i(s("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>l.value.fecha_entrada=t),type:"date",required:"",min:M.value,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,8,Se),[[m,l.value.fecha_entrada]])]),s("div",null,[e[28]||(e[28]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Fecha de Salida "),s("span",{class:"text-red-500"},"*")],-1)),i(s("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>l.value.fecha_salida=t),type:"date",required:"",min:l.value.fecha_entrada||M.value,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,8,Ne),[[m,l.value.fecha_salida]])]),s("div",null,[e[29]||(e[29]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Adultos "),s("span",{class:"text-red-500"},"*")],-1)),i(s("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>l.value.adultos=t),type:"number",min:"1",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[m,l.value.adultos,void 0,{number:!0}]])]),s("div",null,[e[30]||(e[30]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," NiÃ±os ",-1)),i(s("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>l.value.ninos=t),type:"number",min:"0",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[m,l.value.ninos,void 0,{number:!0}]])])]),w.value>0?(n(),r("div",Ve,[s("p",$e,[e[31]||(e[31]=u(" ðŸ“… Total de noches: ",-1)),s("strong",null,o(w.value),1)])])):H("",!0)],512),[[$,c.value===1]]),i(s("div",null,[e[36]||(e[36]=s("h2",{class:"text-2xl font-bold text-gray-800 mb-6"},"Paso 2: Seleccionar Habitaciones",-1)),h(g,{onClick:Z,loading:R.value,class:"mb-4"},{default:b(()=>[...e[33]||(e[33]=[u(" ðŸ”„ Cargar Habitaciones Disponibles ",-1)])]),_:1},8,["loading"]),U.value?k.value.length===0?(n(),r("div",De," âŒ No hay habitaciones disponibles en este hotel para las fechas seleccionadas. ")):(n(),r("div",Ie,[(n(!0),r(f,null,y(k.value,t=>(n(),r("div",{key:t.id,onClick:v=>ee(t),class:j(["border-2 rounded-lg p-4 cursor-pointer transition-all",F(t.id)?"border-blue-600 bg-blue-50":"border-gray-300 hover:border-blue-400"])},[s("div",Ue,[s("h3",Be,"ðŸšª "+o(t.numero),1),F(t.id)?(n(),r("span",qe,"âœ“")):H("",!0)]),s("p",Ee,o(t.tipo?.nombre),1),s("p",Pe,"Capacidad: "+o(t.tipo?.capacidad)+" personas",1),s("p",je,o(q(t.tipo?.precio_base))+"/noche ",1)],10,Re))),128))])):(n(),r("div",Ae," Haz clic en el botÃ³n para cargar habitaciones disponibles ")),l.value.habitaciones.length>0?(n(),r("div",Te,[s("p",Me,[e[34]||(e[34]=u(" âœ“ ",-1)),s("strong",null,o(l.value.habitaciones.length),1),e[35]||(e[35]=u(" habitaciÃ³n(es) seleccionada(s) ",-1))])])):H("",!0)],512),[[$,c.value===2]]),i(s("div",null,[e[42]||(e[42]=s("h2",{class:"text-2xl font-bold text-gray-800 mb-6"},"Paso 3: HuÃ©spedes Adicionales (Opcional)",-1)),e[43]||(e[43]=s("p",{class:"text-gray-600 mb-4"},"Agrega otros huÃ©spedes que se alojarÃ¡n en esta reserva",-1)),s("div",ze,[e[39]||(e[39]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Seleccionar huÃ©sped ",-1)),s("div",Fe,[i(s("select",{"onUpdate:modelValue":e[9]||(e[9]=t=>_.value=t),class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[e[37]||(e[37]=s("option",{value:""},"Selecciona un huÃ©sped",-1)),(n(!0),r(f,null,y(W.value,t=>(n(),r("option",{key:t.id,value:t.id},o(t.nombre)+" "+o(t.apellido)+" - "+o(t.ci),9,Oe))),128))],512),[[E,_.value]]),h(g,{onClick:se},{default:b(()=>[...e[38]||(e[38]=[u(" + Agregar ",-1)])]),_:1})])]),l.value.huespedes_adicionales.length>0?(n(),r("div",Le,[e[40]||(e[40]=s("h3",{class:"font-medium text-gray-700 mb-3"},"HuÃ©spedes agregados:",-1)),(n(!0),r(f,null,y(l.value.huespedes_adicionales,(t,v)=>(n(),r("div",{key:v,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[s("span",null,"ðŸ‘¤ "+o(O(t)),1),s("button",{onClick:hs=>te(v),class:"text-red-600 hover:text-red-800",title:"Remover"}," âŒ ",8,Ge)]))),128))])):(n(),r("div",Je,[...e[41]||(e[41]=[s("p",{class:"text-lg mb-2"},"ðŸ‘¥",-1),s("p",null,"No hay huÃ©spedes adicionales agregados",-1),s("p",{class:"text-sm mt-2"},"Puedes continuar sin agregar mÃ¡s huÃ©spedes",-1)])]))],512),[[$,c.value===3]]),i(s("div",null,[e[52]||(e[52]=s("h2",{class:"text-2xl font-bold text-gray-800 mb-6"},"Paso 4: Resumen de la Reserva",-1)),s("div",Ke,[s("div",Qe,[e[50]||(e[50]=s("h3",{class:"font-bold text-lg mb-3"},"ðŸ“‹ InformaciÃ³n BÃ¡sica",-1)),s("div",We,[s("div",null,[e[44]||(e[44]=s("span",{class:"text-gray-600"},"Hotel:",-1)),s("span",Xe,o(ne()),1)]),s("div",null,[e[45]||(e[45]=s("span",{class:"text-gray-600"},"HuÃ©sped:",-1)),s("span",Ye,o(re()),1)]),s("div",null,[e[46]||(e[46]=s("span",{class:"text-gray-600"},"Entrada:",-1)),s("span",Ze,o(L(l.value.fecha_entrada)),1)]),s("div",null,[e[47]||(e[47]=s("span",{class:"text-gray-600"},"Salida:",-1)),s("span",es,o(L(l.value.fecha_salida)),1)]),s("div",null,[e[48]||(e[48]=s("span",{class:"text-gray-600"},"Noches:",-1)),s("span",ss,o(w.value),1)]),s("div",null,[e[49]||(e[49]=s("span",{class:"text-gray-600"},"Personas:",-1)),s("span",ts,o(l.value.adultos+l.value.ninos)+" ("+o(l.value.adultos)+" adultos, "+o(l.value.ninos)+" niÃ±os)",1)])])]),s("div",ls,[s("h3",as,"ðŸ¨ Habitaciones Seleccionadas ("+o(l.value.habitaciones.length)+")",1),s("div",os,[(n(!0),r(f,null,y(l.value.habitaciones,t=>(n(),r("div",{key:t.id_habitacion,class:"flex justify-between items-center text-sm bg-white p-3 rounded"},[s("span",null,o(ie(t.id_habitacion)),1),s("span",ns,o(q(ue(t.id_habitacion))),1)]))),128))])]),l.value.huespedes_adicionales.length>0?(n(),r("div",rs,[s("h3",is,"ðŸ‘¥ HuÃ©spedes Adicionales ("+o(l.value.huespedes_adicionales.length)+")",1),s("ul",us,[(n(!0),r(f,null,y(l.value.huespedes_adicionales,t=>(n(),r("li",{key:t,class:"text-sm"}," â€¢ "+o(O(t)),1))),128))])])):H("",!0),s("div",ds,[s("div",ps,[e[51]||(e[51]=s("div",null,[s("p",{class:"text-sm opacity-90"},"Total Estimado de la Reserva"),s("p",{class:"text-xs opacity-75 mt-1"},"(Solo habitaciones, sin servicios adicionales)")],-1)),s("p",cs,o(q(X.value)),1)])])])],512),[[$,c.value===4]]),V.value?(n(),r("div",vs," âš ï¸ "+o(V.value),1)):H("",!0),s("div",bs,[c.value>1?(n(),P(g,{key:0,type:"button",variant:"secondary",onClick:e[10]||(e[10]=t=>c.value--)},{default:b(()=>[...e[53]||(e[53]=[u(" â† Anterior ",-1)])]),_:1})):(n(),r("div",ms)),s("div",gs,[h(g,{type:"button",variant:"secondary",onClick:e[11]||(e[11]=t=>a.$router.back())},{default:b(()=>[...e[54]||(e[54]=[u(" Cancelar ",-1)])]),_:1}),c.value<4?(n(),P(g,{key:0,type:"button",onClick:ae,disabled:!z.value},{default:b(()=>[...e[55]||(e[55]=[u(" Siguiente â†’ ",-1)])]),_:1},8,["disabled"])):(n(),P(g,{key:1,type:"button",onClick:oe,loading:D.value},{default:b(()=>[...e[56]||(e[56]=[u(" âœ“ Crear Reserva ",-1)])]),_:1},8,["loading"]))])])]),h(ge,{show:S.value,onClose:e[18]||(e[18]=t=>S.value=!1),title:"Registrar Nuevo HuÃ©sped",size:"lg"},{footer:b(()=>[h(g,{variant:"secondary",onClick:e[17]||(e[17]=t=>S.value=!1)},{default:b(()=>[...e[62]||(e[62]=[u("Cancelar",-1)])]),_:1}),h(g,{onClick:le,loading:B.value},{default:b(()=>[...e[63]||(e[63]=[u("Guardar HuÃ©sped",-1)])]),_:1},8,["loading"])]),default:b(()=>[s("div",fs,[s("div",null,[e[57]||(e[57]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nombre *",-1)),i(s("input",{"onUpdate:modelValue":e[12]||(e[12]=t=>d.value.nombre=t),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Nombre"},null,512),[[m,d.value.nombre]])]),s("div",null,[e[58]||(e[58]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Apellido *",-1)),i(s("input",{"onUpdate:modelValue":e[13]||(e[13]=t=>d.value.apellido=t),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Apellido"},null,512),[[m,d.value.apellido]])]),s("div",null,[e[59]||(e[59]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"CI *",-1)),i(s("input",{"onUpdate:modelValue":e[14]||(e[14]=t=>d.value.ci=t),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"CÃ©dula de Identidad"},null,512),[[m,d.value.ci]])]),s("div",null,[e[60]||(e[60]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"TelÃ©fono",-1)),i(s("input",{"onUpdate:modelValue":e[15]||(e[15]=t=>d.value.telefono=t),type:"text",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"TelÃ©fono"},null,512),[[m,d.value.telefono]])]),s("div",ys,[e[61]||(e[61]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email",-1)),i(s("input",{"onUpdate:modelValue":e[16]||(e[16]=t=>d.value.email=t),type:"email",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"correo@ejemplo.com"},null,512),[[m,d.value.email]])])])]),_:1},8,["show"])]))}};export{Ss as default};
