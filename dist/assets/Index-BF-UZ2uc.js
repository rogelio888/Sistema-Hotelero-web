import{r as l,h as N,c as r,a as o,i as v,e as p,p as w,F as V,A as $,v as _,m as c,y as A,H as d,q as D,o as u,t as i,s as F,d as T,n as O}from"./index-CTzTmT_K.js";import{_ as B}from"./Table-fkUJsl3I.js";const H={class:"p-6"},I={class:"flex space-x-4 mb-4"},L=["value"],U={class:"font-medium text-gray-900"},P={class:"text-sm text-gray-500"},S={class:"flex space-x-2 justify-end"},j=["onClick"],q=["onClick"],z=["onClick"],K={__name:"Index",setup(R){const x=D(),b=l([]),f=l([]),m=l(!1),n=l({id_habitacion:"",fecha_inicio:"",fecha_fin:""}),y=[{key:"id",label:"ID",sortable:!0},{key:"reserva",label:"HabitaciÃ³n",sortable:!1},{key:"descripcion",label:"DescripciÃ³n",sortable:!0},{key:"fecha",label:"Fecha",sortable:!0},{key:"costo",label:"Costo",sortable:!0},{key:"estado",label:"Estado",sortable:!0},{key:"acciones",label:"Acciones",sortable:!1}],g=async()=>{try{const t=await d.get("/api/habitaciones");f.value=t.data.data}catch(t){console.error("Error al cargar habitaciones",t),alert("No se pudieron cargar las habitaciones")}},s=async()=>{m.value=!0;try{const t={};n.value.id_habitacion&&(t.id_habitacion=n.value.id_habitacion),n.value.fecha_inicio&&(t.fecha_inicio=n.value.fecha_inicio),n.value.fecha_fin&&(t.fecha_fin=n.value.fecha_fin);const a=await d.get("/api/mantenimientos",{params:t});b.value=a.data.data}catch(t){console.error("Error al cargar mantenimientos",t),alert("Error al obtener los mantenimientos")}finally{m.value=!1}},k=t=>{x.push(`/mantenimientos/${t}/editar`)},C=async t=>{if(confirm("Â¿Eliminar este mantenimiento?"))try{await d.delete(`/api/mantenimientos/${t}`),alert("Mantenimiento eliminado"),s()}catch(a){console.error("Error al eliminar",a),alert("No se pudo eliminar")}},M=async t=>{if(confirm("Â¿Marcar como completado?"))try{await d.post(`/api/mantenimientos/${t}/completar`),alert("Mantenimiento completado"),s()}catch(a){console.error("Error al completar",a),alert("No se pudo completar")}};return N(()=>{g(),s()}),(t,a)=>{const E=A("router-link");return u(),r("div",H,[a[5]||(a[5]=o("h1",{class:"text-2xl font-bold mb-4"},"Mantenimientos",-1)),o("div",I,[p(o("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>n.value.id_habitacion=e),class:"border rounded p-2"},[a[3]||(a[3]=o("option",{value:""},"Todas las habitaciones",-1)),(u(!0),r(V,null,$(f.value,e=>(u(),r("option",{key:e.id,value:e.id},i(e.numero)+" - "+i(e.hotel?.nombre||""),9,L))),128))],512),[[w,n.value.id_habitacion]]),p(o("input",{type:"date","onUpdate:modelValue":a[1]||(a[1]=e=>n.value.fecha_inicio=e),class:"border rounded p-2",placeholder:"Fecha inicio"},null,512),[[_,n.value.fecha_inicio]]),p(o("input",{type:"date","onUpdate:modelValue":a[2]||(a[2]=e=>n.value.fecha_fin=e),class:"border rounded p-2",placeholder:"Fecha fin"},null,512),[[_,n.value.fecha_fin]]),o("button",{onClick:s,class:"bg-blue-500 text-white px-4 py-2 rounded"},"Filtrar"),v(E,{to:{name:"MantenimientosCreate"},class:"bg-green-500 text-white px-4 py-2 rounded"},{default:c(()=>[...a[4]||(a[4]=[F("Nuevo Mantenimiento",-1)])]),_:1})]),v(B,{columns:y,data:b.value,loading:m.value},{"cell-reserva":c(({item:e})=>[o("div",null,[o("p",U,i(e.habitacion?.numero||"N/A"),1),o("p",P,i(e.habitacion?.hotel?.nombre||""),1)])]),"cell-estado":c(({item:e})=>[o("span",{class:O(["px-2 py-1 text-xs font-semibold rounded-full",{"bg-green-100 text-green-800":e.estado==="ACTIVO","bg-red-100 text-red-800":e.estado==="COMPLETADO"}])},i(e.estado),3)]),"cell-acciones":c(({item:e})=>[o("div",S,[o("button",{onClick:h=>k(e.id),class:"text-blue-500 hover:text-blue-600",title:"Editar"}," âœï¸ ",8,j),o("button",{onClick:h=>C(e.id),class:"text-red-500 hover:text-red-600",title:"Eliminar"}," ðŸ—‘ï¸ ",8,q),e.estado!=="COMPLETADO"?(u(),r("button",{key:0,onClick:h=>M(e.id),class:"text-green-500 hover:text-green-600",title:"Completar"}," âœ… ",8,z)):T("",!0)])]),_:1},8,["data","loading"])])}}};export{K as default};
