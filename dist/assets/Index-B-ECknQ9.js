import{u as D,r as i,h as O,c as d,a as l,i as v,k as j,d as g,l as b,m as t,e as _,p as E,F as $,A as h,j as y,q as z,o as r,s as u,t as a,n as F}from"./index-CTzTmT_K.js";import{u as L}from"./hoteles-UglgslUa.js";import{_ as q}from"./Table-fkUJsl3I.js";import{_ as x}from"./Button-Dd-4xSWI.js";import{M as N}from"./Modal-ClueKbjA.js";const G={class:"flex items-center justify-between mb-6"},J={class:"bg-white rounded-lg shadow p-4 mb-6"},K={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Q=["value"],W=["value"],X={class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-semibold"},Y={class:"flex items-center space-x-2"},Z=["onClick"],ee=["onClick"],oe=["onClick"],le={key:0},se={class:"mb-4 p-4 bg-gray-50 rounded-lg"},te={class:"font-medium"},ae={class:"text-sm text-gray-600"},re={class:"max-h-96 overflow-y-auto"},ne={class:"grid grid-cols-2 gap-2"},de={class:"text-gray-700"},fe={__name:"Index",setup(ie){const P=z(),k=D(),V=L(),I=i([]),S=i([]),C=i(!1),f=i(!1),p=i(!1),n=i(null),w=i(!1),m=i({id_hotel:"",id_rol:"",estado:""}),T=[{key:"id",label:"ID"},{key:"nombre",label:"Nombre Completo"},{key:"usuario",label:"Usuario"},{key:"rol",label:"Rol"},{key:"hotel",label:"Hotel"},{key:"estado",label:"Estado"}],c=async()=>{C.value=!0;try{const s=new URLSearchParams(m.value),e=await y.get(`/empleados?${s}`);e.data.success&&(I.value=e.data.data)}catch(s){console.error("Error al cargar empleados:",s)}finally{C.value=!1}},R=async()=>{try{const s=await y.get("/roles");s.data.success&&(S.value=s.data.data)}catch(s){console.error("Error al cargar roles:",s)}},U=async s=>{try{const e=await y.get(`/empleados/${s.id}`);e.data.success&&(n.value=e.data.data,f.value=!0)}catch{alert("Error al cargar permisos")}},B=s=>{P.push(`/empleados/${s}/editar`)},H=s=>{n.value=s,p.value=!0},M=async()=>{w.value=!0;try{await y.delete(`/empleados/${n.value.id}`),p.value=!1,await c()}catch{alert("Error al inactivar empleado")}finally{w.value=!1}};return O(()=>{V.fetchHoteles(),R(),c()}),(s,e)=>(r(),d("div",null,[l("div",G,[e[9]||(e[9]=l("div",null,[l("h1",{class:"text-3xl font-bold text-gray-800"},"Empleados"),l("p",{class:"text-gray-600 mt-1"},"Administra todos los empleados del sistema")],-1)),b(k).hasPermission("crear_empleados")?(r(),j(x,{key:0,onClick:e[0]||(e[0]=o=>s.$router.push("/empleados/crear"))},{default:t(()=>[...e[8]||(e[8]=[u(" âž• Nuevo Empleado ",-1)])]),_:1})):g("",!0)]),l("div",J,[l("div",K,[l("div",null,[e[11]||(e[11]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Hotel",-1)),_(l("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>m.value.id_hotel=o),onChange:c,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[e[10]||(e[10]=l("option",{value:""},"Todos",-1)),(r(!0),d($,null,h(b(V).hoteles,o=>(r(),d("option",{key:o.id,value:o.id},a(o.nombre),9,Q))),128))],544),[[E,m.value.id_hotel]])]),l("div",null,[e[13]||(e[13]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rol",-1)),_(l("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>m.value.id_rol=o),onChange:c,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[e[12]||(e[12]=l("option",{value:""},"Todos",-1)),(r(!0),d($,null,h(S.value,o=>(r(),d("option",{key:o.id,value:o.id},a(o.nombre),9,W))),128))],544),[[E,m.value.id_rol]])]),l("div",null,[e[15]||(e[15]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Estado",-1)),_(l("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>m.value.estado=o),onChange:c,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[...e[14]||(e[14]=[l("option",{value:""},"Todos",-1),l("option",{value:"ACTIVO"},"Activo",-1),l("option",{value:"INACTIVO"},"Inactivo",-1)])],544),[[E,m.value.estado]])])])]),v(q,{columns:T,data:I.value,loading:C.value},{"cell-nombre":t(({item:o})=>[u(a(o.nombre)+" "+a(o.apellido),1)]),"cell-rol":t(({item:o})=>[l("span",X,a(o.rol?.nombre),1)]),"cell-hotel":t(({item:o})=>[u(a(o.hotel?.nombre||"Sin asignar"),1)]),"cell-estado":t(({item:o})=>[l("span",{class:F(["px-3 py-1 rounded-full text-xs font-semibold",o.estado==="ACTIVO"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"])},a(o.estado),3)]),actions:t(({item:o})=>[l("div",Y,[l("button",{onClick:A=>U(o),class:"text-blue-600 hover:text-blue-800",title:"Ver permisos"}," ðŸ”‘ ",8,Z),b(k).hasPermission("editar_empleados")?(r(),d("button",{key:0,onClick:A=>B(o.id),class:"text-yellow-600 hover:text-yellow-800",title:"Editar"}," âœï¸ ",8,ee)):g("",!0),b(k).hasPermission("eliminar_empleados")?(r(),d("button",{key:1,onClick:A=>H(o),class:"text-red-600 hover:text-red-800",title:"Inactivar"}," ðŸ—‘ï¸ ",8,oe)):g("",!0)])]),_:1},8,["data","loading"]),v(N,{show:f.value,onClose:e[5]||(e[5]=o=>f.value=!1),title:"Permisos del Empleado",size:"lg"},{footer:t(()=>[v(x,{onClick:e[4]||(e[4]=o=>f.value=!1)},{default:t(()=>[...e[17]||(e[17]=[u("Cerrar",-1)])]),_:1})]),default:t(()=>[n.value?(r(),d("div",le,[l("div",se,[l("p",te,a(n.value.nombre)+" "+a(n.value.apellido),1),l("p",ae,"Rol: "+a(n.value.rol?.nombre),1)]),l("div",re,[l("div",ne,[(r(!0),d($,null,h(n.value.rol?.permisos,o=>(r(),d("div",{key:o.id,class:"flex items-center p-2 bg-green-50 rounded text-sm"},[e[16]||(e[16]=l("span",{class:"mr-2"},"âœ“",-1)),l("span",null,a(o.descripcion),1)]))),128))])])])):g("",!0)]),_:1},8,["show"]),v(N,{show:p.value,onClose:e[7]||(e[7]=o=>p.value=!1),title:"Confirmar inactivaciÃ³n"},{footer:t(()=>[v(x,{variant:"secondary",onClick:e[6]||(e[6]=o=>p.value=!1)},{default:t(()=>[...e[20]||(e[20]=[u("Cancelar",-1)])]),_:1}),v(x,{variant:"danger",onClick:M,loading:w.value},{default:t(()=>[...e[21]||(e[21]=[u("Confirmar",-1)])]),_:1},8,["loading"])]),default:t(()=>[l("p",de,[e[18]||(e[18]=u(" Â¿EstÃ¡s seguro de inactivar al empleado ",-1)),l("strong",null,a(n.value?.nombre)+" "+a(n.value?.apellido),1),e[19]||(e[19]=u("? ",-1))])]),_:1},8,["show"])]))}};export{fe as default};
