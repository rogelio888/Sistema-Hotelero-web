import{z as I,j as m,u as U,r as c,h as z,c as P,a as t,i as p,k as F,d as k,l as v,m as i,o as b,s as f,w as T,e as _,v as $,t as q}from"./app-DWQ7THlv.js";import{_ as G}from"./Table-Cma2KXjz.js";import{_ as y}from"./Button-AgtSY3Ng.js";import{M as N}from"./Modal-B7Mg5LTC.js";/* empty css            */const L=I("pisos",{state:()=>({pisos:[],pisoActual:null,loading:!1,error:null}),getters:{totalPisos:o=>o.pisos.length},actions:{async fetchPisos(o={}){this.loading=!0,this.error=null;try{const s=new URLSearchParams(o),a=await m.get(`/pisos?${s}`);a.data.success&&(this.pisos=a.data.data)}catch(s){throw this.error=s.response?.data?.message||"Error al cargar pisos",s}finally{this.loading=!1}},async fetchPiso(o){this.loading=!0,this.error=null;try{const s=await m.get(`/pisos/${o}`);if(s.data.success)return this.pisoActual=s.data.data,s.data.data}catch(s){throw this.error=s.response?.data?.message||"Error al cargar piso",s}finally{this.loading=!1}},async createPiso(o){this.loading=!0,this.error=null;try{const s=await m.post("/pisos",o);if(s.data.success)return this.pisos.push(s.data.data),s.data}catch(s){throw this.error=s.response?.data?.message||"Error al crear piso",s}finally{this.loading=!1}},async updatePiso(o,s){this.loading=!0,this.error=null;try{const a=await m.put(`/pisos/${o}`,s);if(a.data.success){const l=this.pisos.findIndex(u=>u.id===o);return l!==-1&&(this.pisos[l]=a.data.data),a.data}}catch(a){throw this.error=a.response?.data?.message||"Error al actualizar piso",a}finally{this.loading=!1}},async deletePiso(o){this.loading=!0,this.error=null;try{const s=await m.delete(`/pisos/${o}`);if(s.data.success)return this.pisos=this.pisos.filter(a=>a.id!==o),s.data}catch(s){throw this.error=s.response?.data?.message||"Error al eliminar piso",s}finally{this.loading=!1}}}}),R={class:"flex items-center justify-between mb-6"},H={class:"flex items-center space-x-2"},J=["onClick"],K=["onClick"],O={class:"space-y-4"},Q={class:"mt-6 flex justify-end space-x-3"},W={class:"text-gray-700"},as={__name:"Index",setup(o){const s=U(),a=L(),l=c(!1),u=c(!1),g=c(!1),h=c(null),x=c(!1),w=c(!1),r=c({id:null,nombre:"",descripcion:""}),S=[{key:"id",label:"ID"},{key:"nombre",label:"Nombre"},{key:"descripcion",label:"DescripciÃ³n"}],E=async()=>{try{await a.fetchPisos()}catch(n){console.error("Error al cargar pisos:",n)}},M=()=>{g.value=!1,r.value={id:null,nombre:"",descripcion:""},l.value=!0},V=n=>{g.value=!0,r.value={...n},l.value=!0},C=()=>{l.value=!1,r.value={id:null,nombre:"",descripcion:""}},D=async()=>{x.value=!0;try{g.value?await a.updatePiso(r.value.id,r.value):await a.createPiso(r.value),l.value=!1,E()}catch{alert("Error al guardar piso")}finally{x.value=!1}},j=n=>{h.value=n,u.value=!0},A=async()=>{w.value=!0;try{await a.deletePiso(h.value.id),u.value=!1,h.value=null}catch{alert("Error al eliminar piso")}finally{w.value=!1}};return z(()=>{E()}),(n,e)=>(b(),P("div",null,[t("div",R,[e[5]||(e[5]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-800"},"Pisos"),t("p",{class:"text-gray-600 mt-1"},"Administra los pisos del hotel")],-1)),v(s).hasPermission("crear_pisos")?(b(),F(y,{key:0,onClick:M},{default:i(()=>[...e[4]||(e[4]=[f(" âž• Nuevo Piso ",-1)])]),_:1})):k("",!0)]),p(G,{columns:S,data:v(a).pisos,loading:v(a).loading},{actions:i(({item:d})=>[t("div",H,[v(s).hasPermission("editar_pisos")?(b(),P("button",{key:0,onClick:B=>V(d),class:"text-yellow-600 hover:text-yellow-800",title:"Editar"}," âœï¸ ",8,J)):k("",!0),v(s).hasPermission("eliminar_pisos")?(b(),P("button",{key:1,onClick:B=>j(d),class:"text-red-600 hover:text-red-800",title:"Eliminar"}," ðŸ—‘ï¸ ",8,K)):k("",!0)])]),_:1},8,["data","loading"]),p(N,{show:l.value,onClose:C,title:g.value?"Editar Piso":"Nuevo Piso"},{default:i(()=>[t("form",{onSubmit:T(D,["prevent"])},[t("div",O,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nombre / NÃºmero",-1)),_(t("input",{"onUpdate:modelValue":e[0]||(e[0]=d=>r.value.nombre=d),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Ej. Piso 1"},null,512),[[$,r.value.nombre]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"DescripciÃ³n",-1)),_(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=d=>r.value.descripcion=d),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",rows:"3"},null,512),[[$,r.value.descripcion]])])]),t("div",Q,[p(y,{type:"button",variant:"secondary",onClick:C},{default:i(()=>[...e[8]||(e[8]=[f("Cancelar",-1)])]),_:1}),p(y,{type:"submit",loading:x.value},{default:i(()=>[...e[9]||(e[9]=[f("Guardar",-1)])]),_:1},8,["loading"])])],32)]),_:1},8,["show","title"]),p(N,{show:u.value,onClose:e[3]||(e[3]=d=>u.value=!1),title:"Confirmar eliminaciÃ³n"},{footer:i(()=>[p(y,{variant:"secondary",onClick:e[2]||(e[2]=d=>u.value=!1)},{default:i(()=>[...e[12]||(e[12]=[f("Cancelar",-1)])]),_:1}),p(y,{variant:"danger",onClick:A,loading:w.value},{default:i(()=>[...e[13]||(e[13]=[f("Eliminar",-1)])]),_:1},8,["loading"])]),default:i(()=>[t("p",W,[e[10]||(e[10]=f("Â¿EstÃ¡s seguro de eliminar el piso ",-1)),t("strong",null,q(h.value?.nombre),1),e[11]||(e[11]=f("?",-1))])]),_:1},8,["show"])]))}};export{as as default};
