import{r as g,h as W,c as i,a as t,d as p,i as f,t as a,k as x,n as E,m as n,F as h,A as R,x as X,q as Y,o as l,s as d,e as N,p as z,v as I,j as M}from"./app-DWQ7THlv.js";import{u as Z}from"./reservas-Cq-m4-rN.js";import{u as ee}from"./servicios-D_Dy-RAM.js";import{_ as u}from"./Button-AgtSY3Ng.js";import{M as D}from"./Modal-B7Mg5LTC.js";/* empty css            */const te={class:"mb-6"},se={class:"flex items-center justify-between"},oe={class:"text-3xl font-bold text-gray-800"},ae={class:"flex items-center space-x-3"},le={key:0,class:"bg-white rounded-lg shadow p-6 text-center"},re={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ne={class:"lg:col-span-2 space-y-6"},ie={class:"bg-white rounded-lg shadow p-6"},de={class:"grid grid-cols-2 gap-4"},ue={class:"font-medium"},ve={class:"font-medium"},ge={class:"font-medium"},me={class:"font-medium"},pe={class:"font-medium"},ce={class:"font-medium"},fe={class:"bg-white rounded-lg shadow p-6"},xe={class:"grid grid-cols-3 gap-4"},be={class:"text-center p-4 bg-blue-50 rounded-lg"},ye={class:"text-lg font-bold text-blue-600"},Ce={class:"text-center p-4 bg-purple-50 rounded-lg"},we={class:"text-lg font-bold text-purple-600"},_e={class:"text-center p-4 bg-green-50 rounded-lg"},ke={class:"text-lg font-bold text-green-600"},Ee={class:"mt-4 grid grid-cols-2 gap-4"},he={class:"font-medium"},Re={class:"font-medium"},Ne={class:"bg-white rounded-lg shadow p-6"},Se={class:"space-y-3"},Pe={class:"font-medium"},Ae={class:"text-sm text-gray-600"},Oe={class:"text-right"},Te={class:"font-bold text-blue-600"},Ie={class:"text-xs text-gray-500"},De={key:0,class:"bg-white rounded-lg shadow p-6"},je={class:"space-y-2"},$e={class:"font-medium"},Fe={class:"text-sm text-gray-600"},Ve={class:"bg-white rounded-lg shadow p-6"},ze={class:"flex items-center justify-between mb-4"},Me={key:0,class:"text-center py-8 text-gray-400"},Be={key:1,class:"space-y-2"},He={class:"font-medium"},Le={class:"text-sm text-gray-600"},Ue={class:"font-bold text-blue-600"},qe={class:"mt-4 pt-4 border-t border-gray-200"},Ge={class:"flex justify-between items-center"},Je={class:"text-lg font-bold text-blue-600"},Ke={class:"bg-white rounded-lg shadow p-6"},Qe={class:"flex items-center justify-between mb-4"},We={key:0,class:"text-center py-8 text-gray-400"},Xe={key:1,class:"space-y-2"},Ye={class:"font-medium"},Ze={class:"text-sm text-gray-600"},et={class:"font-bold text-green-600"},tt={class:"space-y-6"},st={class:"bg-white rounded-lg shadow p-6 sticky top-6"},ot={class:"space-y-3"},at={class:"flex justify-between pb-3 border-b"},lt={class:"font-medium"},rt={class:"flex justify-between pb-3 border-b"},nt={class:"font-medium"},it={class:"flex justify-between pb-3 border-b"},dt={class:"text-lg font-bold text-blue-600"},ut={class:"flex justify-between pb-3 border-b"},vt={class:"font-medium text-green-600"},gt={class:"flex justify-between pt-2"},mt={class:"bg-white rounded-lg shadow p-6"},pt={class:"space-y-2"},ct={class:"space-y-4"},ft=["value"],xt={class:"space-y-4"},bt={class:"p-4 bg-blue-50 rounded-lg"},yt={class:"text-2xl font-bold text-blue-600"},Ct=["max"],St={__name:"Show",setup(wt){const b=X(),j=Y(),_=Z(),$=ee(),S=g(!0),o=g(null),F=g([]),y=g(!1),C=g(!1),k=g(!1),m=g({id_servicio:"",cantidad:1,fecha:new Date().toISOString().split("T")[0]}),c=g({tipo_pago:"",monto:0}),P=g(!1),A=g(!1),O=g(!1),w=async()=>{S.value=!0;try{o.value=await _.fetchReserva(b.params.id)}catch{alert("Error al cargar reserva"),j.push("/reservas")}finally{S.value=!1}},B=async()=>{try{await $.fetchServicios({estado:"ACTIVO"}),F.value=$.serviciosActivos}catch{console.error("Error al cargar servicios")}},H=async()=>{try{await _.confirmarReserva(b.params.id),await w(),alert("Reserva confirmada exitosamente")}catch{alert("Error al confirmar reserva")}},L=async()=>{if(confirm("Â¿Realizar check-in ahora?"))try{await _.checkIn(b.params.id),await w(),alert("Check-in realizado exitosamente")}catch{alert("Error al realizar check-in")}},U=async()=>{if(o.value.saldo>0){alert("No se puede hacer check-out. Hay saldo pendiente de pago.");return}if(confirm("Â¿Realizar check-out ahora?"))try{await _.checkOut(b.params.id),await w(),alert("Check-out realizado exitosamente")}catch(r){alert(r.response?.data?.message||"Error al realizar check-out")}},q=async()=>{if(!m.value.id_servicio||!m.value.cantidad){alert("Completa todos los campos");return}P.value=!0;try{await M.post("/consumos",{id_reserva:b.params.id,...m.value}),y.value=!1,await w(),m.value={id_servicio:"",cantidad:1,fecha:new Date().toISOString().split("T")[0]}}catch{alert("Error al agregar consumo")}finally{P.value=!1}},G=async()=>{if(!c.value.tipo_pago||!c.value.monto){alert("Completa todos los campos");return}A.value=!0;try{await M.post("/pagos",{id_reserva:b.params.id,...c.value,fecha:new Date().toISOString()}),C.value=!1,await w(),c.value={tipo_pago:"",monto:0},alert("Pago registrado exitosamente")}catch(r){alert(r.response?.data?.message||"Error al registrar pago")}finally{A.value=!1}},J=()=>{k.value=!0},K=async()=>{O.value=!0;try{await _.cancelarReserva(b.params.id),k.value=!1,j.push("/reservas")}catch{alert("Error al cancelar reserva")}finally{O.value=!1}},Q=r=>({PENDIENTE:"bg-yellow-100 text-yellow-800",CONFIRMADA:"bg-blue-100 text-blue-800",EN_PROCESO:"bg-green-100 text-green-800",COMPLETADA:"bg-gray-100 text-gray-800",CANCELADA:"bg-red-100 text-red-800"})[r]||"bg-gray-100 text-gray-800",T=r=>r?new Date(r).toLocaleDateString("es-BO",{day:"2-digit",month:"long",year:"numeric"}):"",V=r=>r?new Date(r).toLocaleString("es-BO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",v=r=>new Intl.NumberFormat("es-BO",{style:"currency",currency:"BOB"}).format(r);return W(()=>{w(),B()}),(r,e)=>(l(),i("div",null,[t("div",te,[t("button",{onClick:e[0]||(e[0]=s=>r.$router.back()),class:"text-blue-600 hover:text-blue-800 mb-4"}," â† Volver "),t("div",se,[t("div",null,[t("h1",oe,"Detalle de Reserva #"+a(o.value?.id),1),e[17]||(e[17]=t("p",{class:"text-gray-600 mt-1"},"InformaciÃ³n completa de la reserva",-1))]),t("div",ae,[t("span",{class:E(["px-4 py-2 rounded-full text-sm font-semibold",Q(o.value?.estado)])},a(o.value?.estado),3),o.value?.estado==="PENDIENTE"?(l(),x(u,{key:0,onClick:H,variant:"success"},{default:n(()=>[...e[18]||(e[18]=[d(" âœ“ Confirmar ",-1)])]),_:1})):p("",!0),o.value?.estado==="CONFIRMADA"?(l(),x(u,{key:1,onClick:L,variant:"success"},{default:n(()=>[...e[19]||(e[19]=[d(" âœ… Check-in ",-1)])]),_:1})):p("",!0),o.value?.estado==="EN_PROCESO"?(l(),x(u,{key:2,onClick:U,variant:"warning"},{default:n(()=>[...e[20]||(e[20]=[d(" ðŸšª Check-out ",-1)])]),_:1})):p("",!0)])])]),S.value?(l(),i("div",le,[...e[21]||(e[21]=[t("p",{class:"text-gray-500"},"Cargando...",-1)])])):o.value?(l(),i("div",re,[t("div",ne,[t("div",ie,[e[28]||(e[28]=t("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"ðŸ“‹ InformaciÃ³n General",-1)),t("div",de,[t("div",null,[e[22]||(e[22]=t("p",{class:"text-sm text-gray-600"},"Hotel",-1)),t("p",ue,a(o.value.hotel?.nombre),1)]),t("div",null,[e[23]||(e[23]=t("p",{class:"text-sm text-gray-600"},"HuÃ©sped Principal",-1)),t("p",ve,a(o.value.huesped?.nombre)+" "+a(o.value.huesped?.apellido),1)]),t("div",null,[e[24]||(e[24]=t("p",{class:"text-sm text-gray-600"},"CI",-1)),t("p",ge,a(o.value.huesped?.ci),1)]),t("div",null,[e[25]||(e[25]=t("p",{class:"text-sm text-gray-600"},"TelÃ©fono",-1)),t("p",me,a(o.value.huesped?.telefono||"N/A"),1)]),t("div",null,[e[26]||(e[26]=t("p",{class:"text-sm text-gray-600"},"Email",-1)),t("p",pe,a(o.value.huesped?.email||"N/A"),1)]),t("div",null,[e[27]||(e[27]=t("p",{class:"text-sm text-gray-600"},"Fecha de Reserva",-1)),t("p",ce,a(V(o.value.created_at)),1)])])]),t("div",fe,[e[34]||(e[34]=t("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"ðŸ“… Fechas de EstadÃ­a",-1)),t("div",xe,[t("div",be,[e[29]||(e[29]=t("p",{class:"text-sm text-gray-600 mb-1"},"Check-in",-1)),t("p",ye,a(T(o.value.fecha_entrada)),1)]),t("div",Ce,[e[30]||(e[30]=t("p",{class:"text-sm text-gray-600 mb-1"},"Check-out",-1)),t("p",we,a(T(o.value.fecha_salida)),1)]),t("div",_e,[e[31]||(e[31]=t("p",{class:"text-sm text-gray-600 mb-1"},"Noches",-1)),t("p",ke,a(o.value.noches),1)])]),t("div",Ee,[t("div",null,[e[32]||(e[32]=t("p",{class:"text-sm text-gray-600"},"Adultos",-1)),t("p",he,a(o.value.adultos),1)]),t("div",null,[e[33]||(e[33]=t("p",{class:"text-sm text-gray-600"},"NiÃ±os",-1)),t("p",Re,a(o.value.ninos),1)])])]),t("div",Ne,[e[35]||(e[35]=t("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"ðŸ¨ Habitaciones",-1)),t("div",Se,[(l(!0),i(h,null,R(o.value.habitaciones,s=>(l(),i("div",{key:s.id,class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},[t("div",null,[t("p",Pe,"HabitaciÃ³n "+a(s.numero),1),t("p",Ae,a(s.tipo?.nombre),1)]),t("div",Oe,[t("p",Te,a(v(s.pivot.total)),1),t("p",Ie,a(v(s.pivot.precio_por_noche))+"/noche Ã— "+a(s.pivot.noches),1)])]))),128))])]),o.value.huespedes_adicionales?.length>0?(l(),i("div",De,[e[37]||(e[37]=t("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"ðŸ‘¥ HuÃ©spedes Adicionales",-1)),t("div",je,[(l(!0),i(h,null,R(o.value.huespedes_adicionales,s=>(l(),i("div",{key:s.id,class:"flex items-center p-3 bg-gray-50 rounded-lg"},[e[36]||(e[36]=t("span",{class:"mr-3"},"ðŸ‘¤",-1)),t("div",null,[t("p",$e,a(s.nombre)+" "+a(s.apellido),1),t("p",Fe,"CI: "+a(s.ci),1)])]))),128))])])):p("",!0),t("div",Ve,[t("div",ze,[e[39]||(e[39]=t("h2",{class:"text-xl font-bold text-gray-800"},"ðŸ›’ Consumos",-1)),o.value.estado==="EN_PROCESO"?(l(),x(u,{key:0,onClick:e[1]||(e[1]=s=>y.value=!0),size:"sm"},{default:n(()=>[...e[38]||(e[38]=[d(" + Agregar Consumo ",-1)])]),_:1})):p("",!0)]),o.value.consumos?.length===0?(l(),i("div",Me,[...e[40]||(e[40]=[t("p",null,"No hay consumos registrados",-1)])])):(l(),i("div",Be,[(l(!0),i(h,null,R(o.value.consumos,s=>(l(),i("div",{key:s.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[t("div",null,[t("p",He,a(s.servicio?.nombre),1),t("p",Le," Cantidad: "+a(s.cantidad)+" | "+a(T(s.fecha)),1)]),t("p",Ue,a(v(s.subtotal)),1)]))),128))])),t("div",qe,[t("div",Ge,[e[41]||(e[41]=t("span",{class:"font-medium"},"Total Consumos:",-1)),t("span",Je,a(v(o.value.total_consumos)),1)])])]),t("div",Ke,[t("div",Qe,[e[43]||(e[43]=t("h2",{class:"text-xl font-bold text-gray-800"},"ðŸ’³ Pagos",-1)),o.value.saldo>0?(l(),x(u,{key:0,onClick:e[2]||(e[2]=s=>C.value=!0),size:"sm",variant:"success"},{default:n(()=>[...e[42]||(e[42]=[d(" + Registrar Pago ",-1)])]),_:1})):p("",!0)]),o.value.pagos?.length===0?(l(),i("div",We,[...e[44]||(e[44]=[t("p",null,"No hay pagos registrados",-1)])])):(l(),i("div",Xe,[(l(!0),i(h,null,R(o.value.pagos,s=>(l(),i("div",{key:s.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[t("div",null,[t("p",Ye,a(s.tipo_pago),1),t("p",Ze,a(V(s.fecha)),1)]),t("p",et,a(v(s.monto)),1)]))),128))]))])]),t("div",tt,[t("div",st,[e[49]||(e[49]=t("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"ðŸ’° Resumen Financiero",-1)),t("div",ot,[t("div",at,[e[45]||(e[45]=t("span",{class:"text-gray-600"},"Habitaciones",-1)),t("span",lt,a(v(o.value.total_habitaciones||0)),1)]),t("div",rt,[e[46]||(e[46]=t("span",{class:"text-gray-600"},"Consumos",-1)),t("span",nt,a(v(o.value.total_consumos||0)),1)]),t("div",it,[e[47]||(e[47]=t("span",{class:"text-lg font-bold"},"Total",-1)),t("span",dt,a(v(o.value.total)),1)]),t("div",ut,[e[48]||(e[48]=t("span",{class:"text-gray-600"},"Pagado",-1)),t("span",vt,a(v(o.value.total_pagos||0)),1)]),t("div",gt,[t("span",{class:E(["text-lg font-bold",o.value.saldo>0?"text-red-600":"text-green-600"])},a(o.value.saldo>0?"Saldo Pendiente":"Pagado"),3),t("span",{class:E(["text-xl font-bold",o.value.saldo>0?"text-red-600":"text-green-600"])},a(v(Math.abs(o.value.saldo||0))),3)])]),t("div",{class:E(["mt-6 p-4 rounded-lg",o.value.saldo>0?"bg-red-50":"bg-green-50"])},[t("p",{class:E(["text-center font-medium",o.value.saldo>0?"text-red-700":"text-green-700"])},a(o.value.saldo>0?"âš ï¸ Pago Pendiente":"âœ“ Totalmente Pagado"),3)],2)]),t("div",mt,[e[53]||(e[53]=t("h3",{class:"font-bold text-gray-800 mb-3"},"âš¡ Acciones RÃ¡pidas",-1)),t("div",pt,[o.value.estado==="EN_PROCESO"?(l(),x(u,{key:0,onClick:e[3]||(e[3]=s=>y.value=!0),variant:"secondary",class:"w-full"},{default:n(()=>[...e[50]||(e[50]=[d(" ðŸ›’ Agregar Consumo ",-1)])]),_:1})):p("",!0),o.value.saldo>0?(l(),x(u,{key:1,onClick:e[4]||(e[4]=s=>C.value=!0),variant:"success",class:"w-full"},{default:n(()=>[...e[51]||(e[51]=[d(" ðŸ’³ Registrar Pago ",-1)])]),_:1})):p("",!0),["PENDIENTE","CONFIRMADA"].includes(o.value.estado)?(l(),x(u,{key:2,onClick:J,variant:"danger",class:"w-full"},{default:n(()=>[...e[52]||(e[52]=[d(" âŒ Cancelar Reserva ",-1)])]),_:1})):p("",!0)])])])])):p("",!0),f(D,{show:y.value,onClose:e[9]||(e[9]=s=>y.value=!1),title:"Agregar Consumo"},{footer:n(()=>[f(u,{variant:"secondary",onClick:e[8]||(e[8]=s=>y.value=!1)},{default:n(()=>[...e[58]||(e[58]=[d("Cancelar",-1)])]),_:1}),f(u,{onClick:q,loading:P.value},{default:n(()=>[...e[59]||(e[59]=[d("Guardar",-1)])]),_:1},8,["loading"])]),default:n(()=>[t("div",ct,[t("div",null,[e[55]||(e[55]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Servicio *",-1)),N(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>m.value.id_servicio=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[e[54]||(e[54]=t("option",{value:""},"Selecciona un servicio",-1)),(l(!0),i(h,null,R(F.value,s=>(l(),i("option",{key:s.id,value:s.id},a(s.nombre)+" - "+a(v(s.precio)),9,ft))),128))],512),[[z,m.value.id_servicio]])]),t("div",null,[e[56]||(e[56]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cantidad *",-1)),N(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>m.value.cantidad=s),type:"number",min:"1",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[I,m.value.cantidad,void 0,{number:!0}]])]),t("div",null,[e[57]||(e[57]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Fecha *",-1)),N(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>m.value.fecha=s),type:"date",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[I,m.value.fecha]])])])]),_:1},8,["show"]),f(D,{show:C.value,onClose:e[14]||(e[14]=s=>C.value=!1),title:"Registrar Pago"},{footer:n(()=>[f(u,{variant:"secondary",onClick:e[13]||(e[13]=s=>C.value=!1)},{default:n(()=>[...e[64]||(e[64]=[d("Cancelar",-1)])]),_:1}),f(u,{onClick:G,loading:A.value,variant:"success"},{default:n(()=>[...e[65]||(e[65]=[d("Registrar Pago",-1)])]),_:1},8,["loading"])]),default:n(()=>[t("div",xt,[t("div",bt,[e[60]||(e[60]=t("p",{class:"text-sm text-gray-600"},"Saldo Pendiente",-1)),t("p",yt,a(v(o.value?.saldo||0)),1)]),t("div",null,[e[62]||(e[62]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de Pago *",-1)),N(t("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>c.value.tipo_pago=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},[...e[61]||(e[61]=[t("option",{value:""},"Selecciona tipo",-1),t("option",{value:"EFECTIVO"},"Efectivo",-1),t("option",{value:"TARJETA"},"Tarjeta",-1),t("option",{value:"TRANSFERENCIA"},"Transferencia",-1)])],512),[[z,c.value.tipo_pago]])]),t("div",null,[e[63]||(e[63]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Monto *",-1)),N(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>c.value.monto=s),type:"number",step:"0.01",max:o.value?.saldo||0,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,8,Ct),[[I,c.value.monto,void 0,{number:!0}]]),t("button",{onClick:e[12]||(e[12]=s=>c.value.monto=o.value?.saldo||0),class:"mt-2 text-sm text-blue-600 hover:text-blue-800"}," Pagar saldo completo ")])])]),_:1},8,["show"]),f(D,{show:k.value,onClose:e[16]||(e[16]=s=>k.value=!1),title:"Cancelar Reserva"},{footer:n(()=>[f(u,{variant:"secondary",onClick:e[15]||(e[15]=s=>k.value=!1)},{default:n(()=>[...e[66]||(e[66]=[d("No",-1)])]),_:1}),f(u,{variant:"danger",onClick:K,loading:O.value},{default:n(()=>[...e[67]||(e[67]=[d("SÃ­, Cancelar",-1)])]),_:1},8,["loading"])]),default:n(()=>[e[68]||(e[68]=t("p",{class:"text-gray-700"},"Â¿EstÃ¡s seguro de cancelar esta reserva?",-1)),e[69]||(e[69]=t("p",{class:"text-sm text-gray-500 mt-2"},"Las habitaciones quedarÃ¡n disponibles nuevamente.",-1))]),_:1},8,["show"])]))}};export{St as default};
